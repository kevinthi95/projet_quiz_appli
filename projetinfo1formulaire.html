<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire de saisie des informations - Confirmation</title>
    <link rel="stylesheet" type="text/css" href="projetinfo1formulaire.css">
    <script>
        // Fonction pour masquer le message aprÃ¨s quelques secondes et rediriger
        function hideMessageAndRedirect1() {
            var messageContainer = document.getElementById('message-container');
            setTimeout(function() {
                messageContainer.style.display = 'none';
                window.location.href = "page_formulaire_inscrit.html"; // Redirection vers la page principale
            }, 5000); // 5000 ms = 5 secondes
        }
        function hideMessageAndRedirect2() {
            var messageContainer = document.getElementById('message-container');
            setTimeout(function() {
                messageContainer.style.display = 'none';
                window.location.href = "projetinfo1page_principal.html"; // Redirection vers la page principale
            }, 5000); // 5000 ms = 5 secondes
        }
    </script>
</head>
<body>
    <h1>Formulaire de saisie des informations</h1>

    <?php
    // VÃ©rifie si le formulaire a Ã©tÃ© soumis
    if ($_SERVER["REQUEST_METHOD"] == "POST") {
        // RÃ©cupÃ¨re les donnÃ©es du formulaire
        $nom = $_POST['nom'];
        $prenom = $_POST['prenom'];
        $email = $_POST['email'];
        $password = $_POST['password'];
        $age = $_POST['age'];
        $pays = $_POST['pays'];
        $passions = $_POST['passions'];

        // Formatte les donnÃ©es pour les enregistrer dans un fichier texte
        $data = "Nom: $nom\nPrÃ©nom: $prenom\nAdresse e-mail: $email\nMot de passe: $password\nÃ‚ge: $age\nPays: $pays\nPassions: $passions\n\n";

        // Chemin du fichier texte oÃ¹ enregistrer les donnÃ©es
        $file = 'utilisateurs.txt';

        // VÃ©rifie si l'utilisateur est dÃ©jÃ  enregistrÃ©
        if (file_exists($file) && strpos(file_get_contents($file), $email) !== false) {
            // Affiche le message d'inscription dÃ©jÃ  existante
            echo '<div id="message-container">Vous Ãªtes dÃ©jÃ  inscrit.</div>';
            echo '<script>hideMessageAndRedirect1();</script>'; // Appelle la fonction pour masquer le message et rediriger
        } else {
            // Ouvre le fichier en mode Ã©criture
            $fp = fopen($file, 'a');

            // Ã‰crit les donnÃ©es dans le fichier
            fwrite($fp, $data);

            // Ferme le fichier
            fclose($fp);

            // Affiche le message de confirmation
            echo '<div id="message-container">Merci! Vos informations ont Ã©tÃ© enregistrÃ©es avec succÃ¨s.</div>';
            echo '<script>hideMessageAndRedirect2();</script>'; // Appelle la fonction pour masquer le message et rediriger
        }
    ?>
    <?php
    }
    ?>

    <form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post">
    <label for="nom">Nom :</label>
            <input type="text" id="nom" name="nom" minlength="1" maxlength="30" required placeholder="Entrez votre nom"><br><br>
                
            <label for="prenom">PrÃ©nom :</label>
            <input type="text" id="prenom" name="prenom" required placeholder="Entrez votre prÃ©nom"><br><br>

            <label for="email">Adresse e-mail :</label>
            <input type="email" id="email" name="email" required placeholder="email@gmail.com"><br><br>

            <label for="password">Mot de passe :</label>
            <input type="password" id="password" name="password" required placeholder="mot de passe"><br><br>

            <label for="age">Ã‚ge :</label>
            <input type="number" id="age" name="age" min="0" required placeholder="18"><br><br>

            <label for="pays">Pays :</label>
            <select id="pays" name="pays" required>
                <option value="">SÃ©lectionnez votre pays</option>
                <option value="france">ğŸ‡«ğŸ‡· France</option>
                <option value="belgique">ğŸ‡§ğŸ‡ª Belgique</option>
                <option value="suisse">ğŸ‡¨ğŸ‡­ Suisse</option>
                <option value="espagne">ğŸ‡ªğŸ‡¸ Espagne</option>
                <option value="allemagne">ğŸ‡©ğŸ‡ª Allemagne</option>
                <option value="royaume-uni">ğŸ‡¬ğŸ‡§ Royaume-Uni</option>
                <option value="italie">ğŸ‡®ğŸ‡¹ Italie</option>
                <option value="monaco">ğŸ‡²ğŸ‡¨ Monaco</option>
                <option value="luxembourg">ğŸ‡±ğŸ‡º Luxembourg</option>
                <option value="portugal">ğŸ‡µğŸ‡¹ Portugal</option>
                <option value="maroc">ğŸ‡²ğŸ‡¦ Maroc</option>
                <option value="tunisie">ğŸ‡¹ğŸ‡³ Tunisie</option>
            </select><br><br>

            <label for="passions">Passions :</label><br>
            <input type="text" id="passions" name="passions" placeholder="Entrez vos passions sÃ©parÃ©es par des virgules"><br><br>
                
            <br><br>
            
            <input type="submit" value="Soumettre"> <br><br>
            <p>Cliquez sur le lien ci-dessous si vous Ãªtes dÃ©jÃ  inscrit :</p>
            <a href="page_formulaire_inscrit.html">Inscrit</a>
            <br><br>
            <a href="projetinfo1page_principal.html">Retour Ã  la page principale</a>
    </form>
</body>
</html>

